{% extends '::index.html.twig' %}
{% block head %}
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{{ username }}</title>
        <link rel="shortcut icon" href="{{ asset('images/icon.ico') }}">
        <link rel="stylesheet" href="{{ asset('css/user_old.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ asset('css/croppie.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ asset('css/bootstrap-theme.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ asset('css/bootstrap.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ asset('css/bootstrap-theme.min.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ asset('flags/css/flag-icon.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ asset('flags/css/flag-icon.min.css') }}" type="text/css">
        <link rel="stylesheet" href="{{ asset('select/dist/css/bootstrap-select.css') }}" type="text/css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="{{ asset('js/bootstrap.min.js') }}"></script>
        <script src="{{ asset('js/croppie.js') }}"></script>
        <script type="text/javascript" src="{{ asset('js/jquery.js')}}"></script>
	</head>
{% endblock %}
{% block header%}
    
{% endblock %}
{% block content %}
    <div class="userinfo">
        <div class="container infoblock">
            <div class="row maininfo">

                <div class="col-xs-3">
					{% if avatar == '' %}
                        <img  class="img-circle" src="{{ asset('images/avatar.png') }}" onmouseover="pointerOn()" onmouseleave="pointerOff()"
                              id="avatar" data-toggle="modal" data-target="#editPhoto">
					{% endif %}
					
					{% if not avatar == '' %}
						<img  class="img-circle" src="{{ asset( avatar ) }}" onmouseover="pointerOn()" onmouseleave="pointerOff()"
						id="avatar" data-toggle="modal" data-target="#editPhoto">
					{% endif %}
                    <!---->
                    
                </div>
				<script>
					function pointerOn() {
						$("#avatar").css('cursor', 'pointer');
					}
					
					function pointerOff() {
						$("#avatar").css('cursor', '');
					}
				</script>
                <!--LOAD AVATAR -->
				<div id="editPhoto" class="modal fade " role="dialog">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
								<h3 class="modal-title">UPLOAD IMAGE</h3>
							</div>
							<div class="modal-body">
                                <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
                                <script src="{{ asset('js/jquery.cropit.js') }}"></script>
                                <div class="image-editor">
									<h5>image editor</h5>
                                    <input type="file" class="cropit-image-input">
                                    <div class="cropit-image-preview"></div>
                                    <div class="image-size-label">
                                        Resize image
                                    </div>
                                    <input type="range" class="cropit-image-zoom-input">
                                    <button class="export">Export</button>
                                </div>

                                <script>
                                    $(function() {
                                        $('.image-editor').cropit({
                                            imageState: {
                                                src: '',
                                            },
                                        });

                                        $('.export').click(function() {
                                            var imageData = $('.image-editor').cropit('export');
                                            var imgData = JSON.stringify(imageData);
                                            $.ajax({
                                                type: "post",
                                                url: "{{path('instasaver_user_en_upload_avatar')}}",
                                                dataType: 'text',
                                                data: {
                                                    imageJSON: imgData
                                                },
                                                success: function(data){
                                                    if (data == 'OK') {
                                                        location.reload();
                                                    } else {
                                                        alert('Avatar wasn\'t changed!')
                                                    }
                                                }
                                            });
                                        });
                                    });
                                </script>
							</div>
							<div class="modal-footer">
							</div>
						</div>
					</div>
				</div>
            </div>
        </div>
    </div>
{% endblock %}

{% block footer %}
    <div class="footer">
        <h3>FOOTER</h3>
    </div>
{% endblock %}